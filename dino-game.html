<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê³µë£¡ ì í”„ ê²Œì„</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      font-family: 'Courier New', monospace;
    }
    h1 {
      color: #e8e8e8;
      font-size: 1.9em;
      margin-bottom: 18px;
      letter-spacing: 3px;
      text-shadow: 0 0 20px rgba(76,175,80,0.6);
    }
    canvas {
      display: block;
      border-radius: 14px;
      box-shadow: 0 0 40px rgba(76,175,80,0.15), 0 20px 60px rgba(0,0,0,0.6);
    }
    #hint {
      color: #666;
      margin-top: 14px;
      font-size: 0.85em;
      letter-spacing: 1px;
    }
  </style>
</head>
<body>
  <h1>ğŸ¦• ê³µë£¡ ì í”„ ê²Œì„</h1>
  <canvas id="c"></canvas>
  <p id="hint">SPACE Â· í´ë¦­ Â· í„°ì¹˜ ë¡œ ì í”„</p>

<script>
const canvas = document.getElementById('c');
const ctx    = canvas.getContext('2d');
canvas.width  = 820;
canvas.height = 310;

// â”€â”€ Constants â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const GY      = 262;   // ground y (top of grass)
const GRAVITY = 0.72;
const JUMP_V  = -16.5;

// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let state   = 'start'; // 'start' | 'play' | 'over'
let score   = 0;
let lives   = 3;
let rocks   = [];
let rTimer  = 0;
let rInterval = 92;
let speed   = 5.2;
let gOffset = 0;        // ground stripe scroll
let invic   = 0;        // invincibility frames

// â”€â”€ Clouds â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const clouds = [
  { x: 140, y: 38, s: 1.0 },
  { x: 400, y: 22, s: 1.35 },
  { x: 660, y: 50, s: 0.85 },
];

// â”€â”€ Dino â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const dino = {
  x: 110, y: GY - 62,
  w: 46,  h: 62,
  vy: 0,
  grounded: true,
  lp: 0,          // leg phase

  jump() {
    if (this.grounded) {
      this.vy = JUMP_V;
      this.grounded = false;
    }
  },

  update() {
    this.vy += GRAVITY;
    this.y  += this.vy;
    if (this.y >= GY - this.h) {
      this.y       = GY - this.h;
      this.vy      = 0;
      this.grounded = true;
    }
    if (this.grounded) this.lp += 0.22;
  },

  draw() {
    if (invic > 0 && Math.floor(invic / 4) % 2 === 1) return; // flash effect
    const x = this.x, y = this.y;

    // Tail
    ctx.fillStyle = '#2E7D32';
    ctx.beginPath();
    ctx.moveTo(x + 4,  y + 30);
    ctx.lineTo(x - 16, y + 50);
    ctx.lineTo(x - 8,  y + 56);
    ctx.lineTo(x + 10, y + 40);
    ctx.closePath();
    ctx.fill();

    // Body
    ctx.fillStyle = '#4CAF50';
    ctx.fillRect(x + 4,  y + 20, 34, 32);

    // Belly (lighter)
    ctx.fillStyle = '#A5D6A7';
    ctx.fillRect(x + 10, y + 26, 18, 20);

    // Neck
    ctx.fillStyle = '#4CAF50';
    ctx.fillRect(x + 18, y + 15, 14, 10);

    // Head
    ctx.fillRect(x + 16, y,  28, 22);

    // Snout
    ctx.fillStyle = '#81C784';
    ctx.fillRect(x + 38, y + 10, 10, 11);

    // Nostril
    ctx.fillStyle = '#2E7D32';
    ctx.fillRect(x + 43, y + 12, 3, 3);

    // Eye white
    ctx.fillStyle = '#fff';
    ctx.fillRect(x + 30, y + 4, 10, 10);
    // Eye pupil
    ctx.fillStyle = '#1a1a1a';
    ctx.fillRect(x + 32, y + 6,  6,  6);
    // Eye shine
    ctx.fillStyle = '#fff';
    ctx.fillRect(x + 36, y + 6,  2,  2);

    // Arm
    ctx.fillStyle = '#388E3C';
    ctx.fillRect(x + 30, y + 22, 10, 5);
    ctx.fillRect(x + 36, y + 24, 8,  4);

    // Legs
    ctx.fillStyle = '#2E7D32';
    if (this.grounded) {
      const a = Math.sin(this.lp) * 7;
      const b = Math.sin(this.lp + Math.PI) * 7;
      ctx.fillRect(x + 10, y + 50, 11, Math.max(4, 12 + a));
      ctx.fillRect(x + 25, y + 50, 11, Math.max(4, 12 + b));
    } else {
      ctx.fillRect(x + 10, y + 50, 11, 8);
      ctx.fillRect(x + 25, y + 50, 11, 8);
    }
  }
};

// â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rrect(x, y, w, h, r) {
  ctx.beginPath();
  ctx.moveTo(x + r, y);
  ctx.lineTo(x + w - r, y);
  ctx.quadraticCurveTo(x + w, y,     x + w, y + r);
  ctx.lineTo(x + w, y + h - r);
  ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
  ctx.lineTo(x + r, y + h);
  ctx.quadraticCurveTo(x, y + h,     x, y + h - r);
  ctx.lineTo(x, y + r);
  ctx.quadraticCurveTo(x, y,         x + r, y);
  ctx.closePath();
}

function heart(cx, cy, color) {
  ctx.fillStyle = color;
  ctx.beginPath();
  ctx.arc(cx - 5, cy, 6, Math.PI, 0);
  ctx.arc(cx + 5, cy, 6, Math.PI, 0);
  ctx.lineTo(cx, cy + 13);
  ctx.closePath();
  ctx.fill();
}

function cloud(x, y, s) {
  ctx.fillStyle = 'rgba(255,255,255,0.82)';
  ctx.beginPath();
  ctx.arc(x,        y + 14*s, 17*s, 0, Math.PI*2);
  ctx.arc(x + 22*s, y,        24*s, 0, Math.PI*2);
  ctx.arc(x + 48*s, y + 14*s, 17*s, 0, Math.PI*2);
  ctx.fill();
}

// â”€â”€ Draw helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function drawBG() {
  // Sky
  const sg = ctx.createLinearGradient(0, 0, 0, GY);
  sg.addColorStop(0,   '#42A5F5');
  sg.addColorStop(1,   '#E1F5FE');
  ctx.fillStyle = sg;
  ctx.fillRect(0, 0, canvas.width, GY);

  // Clouds
  clouds.forEach(c => cloud(c.x, c.y, c.s));

  // Grass top
  ctx.fillStyle = '#7CB342';
  ctx.fillRect(0, GY, canvas.width, 10);

  // Stripe animation
  ctx.fillStyle = '#8BC34A';
  for (let i = 0; i < canvas.width + 40; i += 40) {
    const ox = ((i - gOffset % 40) + canvas.width) % (canvas.width + 40) - 40;
    ctx.fillRect(ox, GY, 20, 6);
  }

  // Dirt
  const dg = ctx.createLinearGradient(0, GY+10, 0, canvas.height);
  dg.addColorStop(0, '#8D6E63');
  dg.addColorStop(1, '#4E342E');
  ctx.fillStyle = dg;
  ctx.fillRect(0, GY + 10, canvas.width, canvas.height - GY - 10);
}

function drawRock(r) {
  const { x, y, w, h } = r;

  // Shadow ellipse
  ctx.fillStyle = 'rgba(0,0,0,0.18)';
  ctx.beginPath();
  ctx.ellipse(x + w/2, GY + 6, w/2 + 6, 5, 0, 0, Math.PI*2);
  ctx.fill();

  // Body gradient
  const rg = ctx.createLinearGradient(x, y, x + w, y + h);
  rg.addColorStop(0,   '#B0BEC5');
  rg.addColorStop(0.5, '#78909C');
  rg.addColorStop(1,   '#546E7A');
  ctx.fillStyle = rg;
  ctx.beginPath();
  ctx.moveTo(x + w * 0.48, y);
  ctx.lineTo(x + w * 0.92, y + h * 0.32);
  ctx.lineTo(x + w,        y + h);
  ctx.lineTo(x,            y + h);
  ctx.lineTo(x + w * 0.06, y + h * 0.38);
  ctx.closePath();
  ctx.fill();

  // Highlight
  ctx.fillStyle = 'rgba(255,255,255,0.22)';
  ctx.beginPath();
  ctx.moveTo(x + w * 0.48, y + 2);
  ctx.lineTo(x + w * 0.78, y + h * 0.26);
  ctx.lineTo(x + w * 0.32, y + h * 0.26);
  ctx.closePath();
  ctx.fill();
}

function drawHUD() {
  // Score box
  ctx.fillStyle = 'rgba(0,0,0,0.35)';
  rrect(10, 8, 130, 34, 8); ctx.fill();
  ctx.fillStyle = '#FFEB3B';
  ctx.font = 'bold 19px "Courier New"';
  ctx.fillText(`ì ìˆ˜  ${score}`, 20, 32);

  // Life boxes
  ctx.fillStyle = 'rgba(0,0,0,0.35)';
  rrect(canvas.width - 130, 8, 120, 34, 8); ctx.fill();
  for (let i = 0; i < 3; i++) {
    heart(canvas.width - 108 + i * 37, 25, i < lives ? '#EF5350' : '#444');
  }
}

function drawGameOver() {
  ctx.fillStyle = 'rgba(0,0,0,0.6)';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  ctx.save();
  ctx.textAlign = 'center';

  // Panel
  ctx.fillStyle = 'rgba(255,255,255,0.08)';
  rrect(canvas.width/2 - 195, 55, 390, 195, 20); ctx.fill();
  ctx.strokeStyle = 'rgba(255,255,255,0.18)';
  ctx.lineWidth = 1.5; ctx.stroke();

  ctx.fillStyle = '#FF5252';
  ctx.font = 'bold 42px "Courier New"';
  ctx.fillText('ê²Œì„ ì˜¤ë²„!', canvas.width/2, 115);

  ctx.fillStyle = '#FFEB3B';
  ctx.font = 'bold 25px "Courier New"';
  ctx.fillText(`ìµœì¢… ì ìˆ˜ : ${score} ì `, canvas.width/2, 165);

  // Restart button
  ctx.fillStyle = '#43A047';
  rrect(canvas.width/2 - 115, 185, 230, 48, 12); ctx.fill();
  ctx.fillStyle = '#fff';
  ctx.font = 'bold 21px "Courier New"';
  ctx.fillText('ë‹¤ì‹œ ì‹œì‘  â†º', canvas.width/2, 216);

  ctx.restore();
}

function drawStartScreen() {
  drawBG();
  dino.draw();

  ctx.fillStyle = 'rgba(0,0,0,0.5)';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  ctx.save();
  ctx.textAlign = 'center';

  ctx.fillStyle = '#fff';
  ctx.font = 'bold 36px "Courier New"';
  ctx.fillText('ğŸ¦•  ê³µë£¡ ì í”„ ê²Œì„', canvas.width/2, 90);

  ctx.font = '16px "Courier New"';
  ctx.fillStyle = '#B3E5FC';
  ctx.fillText('ë°”ìœ„ë¥¼ ì í”„ë¡œ í”¼í•˜ë©´  +1ì   |  ì¶©ëŒí•˜ë©´ ëª©ìˆ¨ -1', canvas.width/2, 140);
  ctx.fillText('ëª©ìˆ¨ 3ê°œë¥¼ ëª¨ë‘ ìƒìœ¼ë©´ ê²Œì„ ì˜¤ë²„!', canvas.width/2, 168);

  ctx.fillStyle = '#43A047';
  rrect(canvas.width/2 - 120, 192, 240, 50, 14); ctx.fill();
  ctx.fillStyle = '#fff';
  ctx.font = 'bold 21px "Courier New"';
  ctx.fillText('ê²Œì„ ì‹œì‘ â–¶', canvas.width/2, 224);

  ctx.restore();
}

// â”€â”€ Rock spawning â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function spawnRock() {
  const h = 28 + Math.random() * 40;
  const w = 20 + Math.random() * 26;
  rocks.push({
    x: canvas.width + 20,
    y: GY - h,
    w, h,
    speed: speed + score * 0.06,
    passed: false
  });
}

// â”€â”€ Collision â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function hits(r) {
  const m = 8;
  return (
    dino.x + m        < r.x + r.w &&
    dino.x + dino.w - m > r.x + m  &&
    dino.y + m        < r.y + r.h &&
    dino.y + dino.h - m > r.y
  );
}

// â”€â”€ Update â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function update() {
  gOffset += speed * 0.45;
  clouds.forEach(c => { c.x -= 0.38; if (c.x + 90 < 0) c.x = canvas.width + 60; });

  dino.update();
  if (invic > 0) invic--;

  rTimer++;
  if (rTimer >= rInterval) {
    spawnRock();
    rTimer = 0;
    if (rInterval > 52) rInterval -= 0.4;
  }

  for (let i = rocks.length - 1; i >= 0; i--) {
    const r = rocks[i];
    r.x -= r.speed;

    if (!r.passed && r.x + r.w < dino.x) {
      r.passed = true;
      score++;
    }

    if (!r.passed && invic === 0 && hits(r)) {
      lives--;
      invic = 55;
      rocks.splice(i, 1);
      if (lives <= 0) { lives = 0; state = 'over'; }
      continue;
    }

    if (r.x + r.w < 0) rocks.splice(i, 1);
  }
}

// â”€â”€ Main draw â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawBG();
  rocks.forEach(drawRock);
  dino.draw();
  drawHUD();
  if (state === 'over') drawGameOver();
}

// â”€â”€ Input â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function canvasXY(e) {
  const rc = canvas.getBoundingClientRect();
  return {
    x: (e.clientX - rc.left) * (canvas.width  / rc.width),
    y: (e.clientY - rc.top)  * (canvas.height / rc.height)
  };
}

function onAction(cx, cy) {
  if (state === 'start') { state = 'play'; return; }
  if (state === 'play')  { dino.jump(); return; }
  if (state === 'over') {
    const bx = canvas.width/2 - 115, by = 185;
    if (cx >= bx && cx <= bx + 230 && cy >= by && cy <= by + 48) restart();
  }
}

function restart() {
  score = 0; lives = 3; rocks = [];
  rTimer = 0; rInterval = 92; speed = 5.2;
  gOffset = 0; invic = 0;
  dino.y = GY - dino.h; dino.vy = 0; dino.grounded = true;
  state = 'play';
}

document.addEventListener('keydown', e => {
  if (e.code === 'Space' || e.code === 'ArrowUp') {
    e.preventDefault();
    if (state === 'start')      { state = 'play'; }
    else if (state === 'play')  { dino.jump(); }
    else if (state === 'over')  { restart(); }
  }
});

canvas.addEventListener('click', e => {
  const p = canvasXY(e); onAction(p.x, p.y);
});

canvas.addEventListener('touchstart', e => {
  e.preventDefault();
  const p = canvasXY(e.touches[0]); onAction(p.x, p.y);
}, { passive: false });

// â”€â”€ Game loop â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function loop() {
  if (state === 'start') drawStartScreen();
  else { if (state === 'play') update(); draw(); }
  requestAnimationFrame(loop);
})();
</script>
</body>
</html>
